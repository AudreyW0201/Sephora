<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data transformation | Sephora</title>
  <meta name="description" content="Chapter 3 Data transformation | Sephora" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data transformation | Sephora" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data transformation | Sephora" />
  
  
  

<meta name="author" content="Zhiyi Guo, Fan Wu, Yujie Wang" />


<meta name="date" content="2019-12-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-sources.html"/>
<link rel="next" href="missing-values.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.46.1/plotly-latest.min.js"></script>
<link href="libs/parallel-coordinates-2.1.8/parcoords.css" rel="stylesheet" />
<script src="libs/parcoords-binding-1.0.0/parcoords.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Sephora</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a><ul>
<li class="chapter" data-level="5.0.1" data-path="results.html"><a href="results.html#popularity"><i class="fa fa-check"></i><b>5.0.1</b> Popularity</a></li>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#price"><i class="fa fa-check"></i><b>5.1</b> Price</a></li>
<li class="chapter" data-level="5.2" data-path="results.html"><a href="results.html#composition-of-products"><i class="fa fa-check"></i><b>5.2</b> Composition of Products</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Sephora</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-transformation" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Data transformation</h1>
<p>Given the nature of this project and the direct data source from Sephora.com, our data needed very little manipulation. However, we do need to transform the data a little bit so that we could import it into R as a data frame. For each observation, the brand name, product name, URL, and category are naturally in forms of characters so we can leave as it to be. However, we have to transform the price, number of reviews, number of “Loves” and ratings columns in a way that we could later use them as numbers, which means we have strip unnecessary symbols or words in these columns. Fortunately, we could carry these steps all in R.</p>
<p>Another issue to resolve in this data is to detect “NA”‘s, or missing values in the data. It is impossible for any observation to be missing product name, brand name, URL, or category given the structure of Sephora’ s website and the fact that we could not have scraped the product off the website if any of these information is missing, so we turned our focus to numeric values of the data set. It is possible for a product have 0 reviews or 0 Loves, but it doesn’t make sense for a product to have a rating of 0. In this case, any product with rating of 0 indicates that no customer has yet to rate the product. Therefore, 0 rating would be a missing value in our data.</p>
<p>Below is our code to transform the data if you wish to see:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">#Remove dollar sign from price column</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">cosmetics<span class="op">$</span>Prices &lt;-<span class="st"> </span><span class="kw">str_remove</span>(cos1<span class="op">$</span>Prices, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">$&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#Capture the current price</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(cosmetics<span class="op">$</span>Prices)) {</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  change =<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  j =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">  <span class="cf">while</span>(change <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>) {</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">    j =<span class="st"> </span>j<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">    <span class="cf">if</span> (j <span class="op">&gt;=</span><span class="st"> </span><span class="kw">nchar</span>(cosmetics<span class="op">$</span>Prices[i])) {</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">      change =<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11">    }</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">    <span class="cf">if</span> (<span class="kw">substr</span>(cosmetics<span class="op">$</span>Prices[i], j, j) <span class="op">==</span><span class="st"> &quot;(&quot;</span>) {</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">      change =<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14">      cosmetics<span class="op">$</span>Prices[i] =<span class="st"> </span><span class="kw">substr</span>(cosmetics<span class="op">$</span>Prices[i], <span class="dv">1</span>, j<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb2-15" data-line-number="15">    }</a>
<a class="sourceLine" id="cb2-16" data-line-number="16">  }</a>
<a class="sourceLine" id="cb2-17" data-line-number="17">}</a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#Transform Prices, Ratings, Reviews, and Loves columns to numeric values</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19">cosmetics<span class="op">$</span>Prices =<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">is.na</span>(cosmetics<span class="op">$</span>Prices), <span class="dv">0</span>, <span class="kw">as.numeric</span>(cosmetics<span class="op">$</span>Prices))</a>
<a class="sourceLine" id="cb2-20" data-line-number="20">cosmetics<span class="op">$</span>Ratings =<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">is.na</span>(cosmetics<span class="op">$</span>Ratings), <span class="dv">0</span>, <span class="kw">as.numeric</span>(cosmetics<span class="op">$</span>Ratings))</a>
<a class="sourceLine" id="cb2-21" data-line-number="21">cosmetics<span class="op">$</span>Reviews =<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">is.na</span>(cosmetics<span class="op">$</span>Reviews), <span class="dv">0</span>, <span class="kw">as.numeric</span>(cosmetics<span class="op">$</span>Reviews))</a>
<a class="sourceLine" id="cb2-22" data-line-number="22">cosmetics<span class="op">$</span>Loves =<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">is.na</span>(cosmetics<span class="op">$</span>Loves), <span class="dv">0</span>, <span class="kw">as.numeric</span>(cosmetics<span class="op">$</span>Loves))</a></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-sources.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="missing-values.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/YOUR yujie980201/Sephora/edit/master/03-cleaning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/YOUR GITHUB yujie980201/Sephora/blob/master/03-cleaning.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
